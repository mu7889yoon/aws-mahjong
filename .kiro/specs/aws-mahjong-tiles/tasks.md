# 実装計画: AWS麻雀牌SVG生成システム

## 概要

TypeScriptを使用してAWS麻雀牌のSVG生成システムを実装します。MPSZ形式のファイル命名規則を採用します。

## タスク

- [x] 1. プロジェクト構造とコアインターフェースのセットアップ
  - [x] 1.1 プロジェクト初期化とディレクトリ構造の作成
    - package.json、tsconfig.json の設定
    - src/, assets/, output/ ディレクトリの作成
    - _Requirements: 4.1_
  - [x] 1.2 コア型定義の作成
    - TileConfig, TileEntry, TileType などの型定義
    - MPSZ形式に対応した型
    - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5_
  - [x] 1.3 テストフレームワークのセットアップ
    - vitest と fast-check のインストール・設定
    - _Requirements: N/A_

- [x] 2. ベース牌テンプレートの作成
  - [x] 2.1 SVGベーステンプレートの作成
    - 17mm x 24mm サイズのSVGテンプレート
    - 牌種類、アイコン、サービス名の3つのプレースホルダー
    - 角丸・影効果の適用
    - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6_
  - [x] 2.2 ベース牌寸法のプロパティテスト
    - **Property 1: ベース牌の寸法**
    - **Validates: Requirements 1.1**

- [x] 3. 設定バリデーターの実装
  - [x] 3.1 TileConfigバリデーターの実装
    - 必須フィールドの検証
    - 牌種類と番号の範囲検証
    - 重複ID検出
    - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6_
  - [x] 3.2 有効設定構造のプロパティテスト
    - **Property 2: 有効な設定構造**
    - **Validates: Requirements 2.2, 2.3, 2.4, 2.5**
  - [x] 3.3 無効設定検証のプロパティテスト
    - **Property 3: 無効な設定の検証エラー**
    - **Validates: Requirements 2.6**

- [x] 4. チェックポイント - 基盤コンポーネントの確認
  - すべてのテストが通ることを確認し、質問があればユーザーに確認

- [x] 5. SVG生成エンジンの実装
  - [x] 5.1 SVGジェネレーターの実装
    - テンプレートへのアイコン埋め込み
    - サービス名テキストの埋め込み
    - 牌種類ラベルの埋め込み
    - _Requirements: 3.1, 3.2, 3.3, 3.5_
  - [x] 5.2 ファイル出力処理の実装
    - MPSZ形式のファイル名生成
    - 出力ディレクトリへの書き込み
    - _Requirements: 3.4, 4.1_
  - [x] 5.3 生成数一致のプロパティテスト
    - **Property 4: 生成数の一致**
    - **Validates: Requirements 3.1**
  - [x] 5.4 コンテンツ埋め込みのプロパティテスト
    - **Property 5: 牌コンテンツの埋め込み**
    - **Validates: Requirements 3.2, 3.3**
  - [x] 5.5 ファイル命名規則のプロパティテスト
    - **Property 6: ファイル命名規則（MPSZ形式）**
    - **Validates: Requirements 3.4**
  - [x] 5.6 SVGラウンドトリップのプロパティテスト
    - **Property 7: SVGラウンドトリップ**
    - **Validates: Requirements 3.6**

- [x] 6. 牌セット管理の実装
  - [x] 6.1 マニフェスト生成の実装
    - tiles-manifest.json の生成
    - 全牌のメタデータ記録
    - _Requirements: 4.2_
  - [x] 6.2 バッチ生成コマンドの実装
    - 全牌の一括生成
    - 生成結果レポート
    - _Requirements: 4.4, 4.5_
  - [x] 6.3 ファイル上書き処理の実装
    - 既存ファイルの上書き
    - _Requirements: 4.3_
  - [x] 6.4 生成出力のプロパティテスト
    - **Property 8: 生成出力**
    - **Validates: Requirements 4.1, 4.2**
  - [x] 6.5 ファイル上書きのプロパティテスト
    - **Property 9: 再生成時のファイル上書き**
    - **Validates: Requirements 4.3**
  - [x] 6.6 バッチレポートのプロパティテスト
    - **Property 10: バッチ生成レポート**
    - **Validates: Requirements 4.5**

- [x] 7. チェックポイント - 生成システムの確認
  - すべてのテストが通ることを確認し、質問があればユーザーに確認

- [x] 8. サンプル設定とCLIの作成
  - [x] 8.1 サンプルtile-config.jsonの作成
    - 34種類の牌とAWSサービスのマッピング
    - _Requirements: 2.1_
  - [x] 8.2 CLIエントリーポイントの作成
    - コマンドライン引数の処理
    - 生成コマンドの実装
    - _Requirements: 4.4_

- [x] 9. 最終チェックポイント - 全体統合確認
  - すべてのテストが通ることを確認し、質問があればユーザーに確認

## 備考

- 各タスクは特定の要件をトレースできるよう参照を含む
- チェックポイントで段階的に検証を行う
- プロパティテストはユニバーサルな正確性を検証
- すべてのテストは必須
